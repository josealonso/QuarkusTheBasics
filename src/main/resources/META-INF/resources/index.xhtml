<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:o="http://omnifaces.org/ui">

<h:head>
    <title>User Invoices</title>
</h:head>

<h:body>
    <h:form id="invoiceForm">
        <h2 style="text-align: center; margin-top: 5rem;"> Your Invoices</h2>

        <p:messages id="messages" showDetail="true" closable="true"/>

        <div class="card">
            <p:dataTable id="invoiceTable" value="#{userInvoiceOptionsBean.userInvoices}" var="userInvoice"
                         reflow="true" 
                         emptyMessage="No invoices found" rowKey="#{userInvoice.id}"
                         paginator="true" rows="10"
                         paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         currentPageReportTemplate="Showing {startRecord}-{endRecord} of {totalRecords} invoices"
                         rowsPerPageTemplate="5,10,15">

                <p:column headerText="Invoice Number">
                    <h:outputText value="#{userInvoice.invoiceNumber}"/>
                </p:column>

                <p:column headerText="Date">
                    <h:outputText value="#{userInvoice.invoiceDate}">
                        <f:convertDateTime pattern="dd-MM-yyyy"/>
                    </h:outputText>
                </p:column>

                <p:column headerText="Customer Name">
                    <h:outputText value="#{userInvoice.customerName}"/>
                </p:column>

                <p:column headerText="Amount">
                    <h:outputText value="#{userInvoice.amount}">
                        <f:convertNumber type="currency" currencySymbol="$"/>
                    </h:outputText>
                </p:column>

                <p:column headerText="Actions">
                    <p:commandButton value="See" action="#{userInvoiceOptionsBean.viewInvoice(invoice.id)}"
                                     update=":invoiceForm:messages" icon="pi pi-search"
                                     style="margin-right: 10%;"/>
                    <p:commandButton value="Delete" action="#{userInvoiceOptionsBean.deleteInvoice(invoice.id)}"
                                     update=":invoiceForm:messages :invoiceForm:invoiceTable"
                                     icon="pi pi-trash"
                                     onclick="return confirm('Are you sure you want to delete this invoice?');"/>
                </p:column>
            </p:dataTable>
        </div>

        <p:commandButton value="New Invoice" action="#{userInvoiceOptionsBean.prepareNewInvoice}"
                         update=":invoiceForm:messages" icon="pi pi-plus"
                         style="margin-top: 5rem; margin-left: 45%;"/>
    </h:form>
</h:body>
</html>
