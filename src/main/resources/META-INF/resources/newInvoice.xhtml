<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<ui:composition template="/templates/template.xhtml">
    <ui:define name="title">New Invoice</ui:define>
    
    <ui:define name="content">
        <div class="card">
            <h2 class="text-900 text-3xl font-medium mb-3">Create New Invoice</h2>
            
            <h:form>
                <p:panel id="formPanel" styleClass="form-panel">
                    <p:messages id="messages" showDetail="false" closable="true" globalOnly="true">
                        <p:autoUpdate />
                    </p:messages>

                    <p:panelGrid columns="2" styleClass="custom-panel-grid">

                        <div class="flex flex-column gap-2">
                        <p:outputLabel id="invoiceNumberLabel" for="invoiceNumber" value="Invoice Number" styleClass="text-900 font-medium"/>
                            <p:inputText id="invoiceNumber" value="#{createInvoiceBean.invoiceNumber}" 
                                placeholder="Invoice Number" required="true"
                                requiredMessage="Invoice Number is required">
                            </p:inputText>
                            <p:message for="invoiceNumber" styleClass="text-red-500"/>
                        </div>

                        <div class="flex flex-column gap-2">
                        <h:outputLabel id="invoiceDateLabel" for="invoiceDate" value="Invoice Date:" styleClass="text-900 font-medium"/>
                            <p:calendar id="invoiceDate" value="#{createInvoiceBean.invoiceDate}" 
                                placeholder="Invoice Date" required="true"
                                requiredMessage="Invoice Date is required"
                                pattern="dd-MM-yyyy">
                            </p:calendar>
                            <p:message for="invoiceDate" styleClass="text-red-500"/>
                        </div>

                        <div class="flex flex-column gap-2">
                        <h:outputLabel id="customerNameLabel" for="customerName" value="Customer Name:" styleClass="text-900 font-medium"/>
                            <p:inputText id="customerName" value="#{createInvoiceBean.customerName}"
                                placeholder="Customer Name" required="true"
                                requiredMessage="Customer Name is required"
                                validatorMessage="Please enter a valid name">
                            </p:inputText>
                            <p:message for="customerName" styleClass="text-red-500"/>
                        </div>

                        <div class="flex flex-column gap-2">
                        <h:outputLabel id="amountLabel" for="amount" value="Amount in euros:" styleClass="text-900 font-medium"/>
                            <p:inputText id="amount" value="#{createInvoiceBean.amount}" 
                                placeholder="Amount" required="true" 
                                requiredMessage="Amount is required">
                            </p:inputText>
                            <p:message for="amount" styleClass="text-red-500"/>
                        </div>

                    </p:panelGrid>

                    <div class="flex justify-content-between mt-3">
                        <p:commandButton id="submitButton" 
                                       value="Create Invoice" 
                                       action="#{createInvoiceBean.submitInvoice}"
                                       update="@form"
                                       styleClass="ui-button-raised"
                                       icon="pi pi-file-export"
                                       onclick="PF('statusDialog').show()"
                                       oncomplete="PF('statusDialog').hide()">
                            <f:param name="paramInvoiceNumber" value="#{invoiceBean.invoiceNumber}" />
                            <f:param name="paramInvoiceDate" value="#{invoiceBean.invoiceDate}" />
                            <f:param name="paramCustomerName" value="#{invoiceBean.customerName}" />
                            <f:param name="paramInvoiceAmount" value="#{invoiceBean.amount}" />
                        </p:commandButton>

                        <p:button value="Back to Invoices" 
                                outcome="listing"
                                styleClass="ui-button-secondary"
                                icon="pi pi-arrow-left"/>
                    </div>
                </p:panel>
            </h:form>

            <p:dialog id="statusDialog" widgetVar="statusDialog" modal="true" draggable="false" closable="false" resizable="false" showHeader="false">
                <p:graphicImage name="images/loading.gif" />
                <h:outputText value="Processing..." />
            </p:dialog>
        </div>
    </ui:define>
</ui:composition>
</html>
